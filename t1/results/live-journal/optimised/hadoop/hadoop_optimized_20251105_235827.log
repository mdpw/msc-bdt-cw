========================================
HADOOP MAPREDUCE - MEMORY OPTIMIZATION
========================================
Dataset: live-journal
Input: soc-LiveJournal1.txt
Start time: Wed Nov  5 11:58:27 PM +0530 2025
Log file: /home/dinesh/bigdata-assignment/results/live-journal/hadoop-optimized/hadoop_optimized_20251105_235827.log

Compiling optimized Hadoop version...
Optimized JAR created: /home/dinesh/bigdata-assignment/hadoop/indegree-optimized.jar
Data file: 1.1G (1080598042 bytes)

Running OPTIMIZED Hadoop MapReduce...
=== HADOOP OPTIMIZATION: MEMORY TUNING ===
Map memory: 3GB (vs 2GB default)
Reduce memory: 4GB (vs 2GB default)
==========================================
Temp: /home/dinesh/bigdata-assignment/results/live-journal/hadoop-optimized/temp-20251105_235827
Output: /home/dinesh/bigdata-assignment/results/live-journal/hadoop-optimized/output-20251105_235827
Check YARN UI at http://localhost:8088 for real-time monitoring
----------------------------------------
=== HADOOP OPTIMIZATION: COMPRESSION ===
Map output compression: Snappy codec enabled
Benefit: Reduces network I/O during shuffle
Target: 193MB shuffle â†’ ~50-70MB compressed
========================================
=== STARTING MAPREDUCE JOB 1: Calculate In-Degrees ===
2025-11-05 23:58:33,871 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2025-11-05 23:58:36,345 WARN mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2025-11-05 23:58:36,450 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/dinesh/.staging/job_1762367237082_0001
2025-11-05 23:58:37,817 INFO input.FileInputFormat: Total input files to process : 1
2025-11-05 23:58:38,467 INFO mapreduce.JobSubmitter: number of splits:33
2025-11-05 23:58:38,755 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1762367237082_0001
2025-11-05 23:58:38,755 INFO mapreduce.JobSubmitter: Executing with tokens: []
2025-11-05 23:58:39,031 INFO conf.Configuration: resource-types.xml not found
2025-11-05 23:58:39,032 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2025-11-05 23:58:39,560 INFO impl.YarnClientImpl: Submitted application application_1762367237082_0001
2025-11-05 23:58:39,656 INFO mapreduce.Job: The url to track the job: http://dinesh-VirtualBox:8088/proxy/application_1762367237082_0001/
2025-11-05 23:58:39,657 INFO mapreduce.Job: Running job: job_1762367237082_0001
2025-11-05 23:58:54,112 INFO mapreduce.Job: Job job_1762367237082_0001 running in uber mode : false
2025-11-05 23:58:54,115 INFO mapreduce.Job:  map 0% reduce 0%
2025-11-05 23:59:19,761 INFO mapreduce.Job:  map 1% reduce 0%
2025-11-05 23:59:25,416 INFO mapreduce.Job:  map 2% reduce 0%
2025-11-05 23:59:27,852 INFO mapreduce.Job:  map 3% reduce 0%
2025-11-05 23:59:30,233 INFO mapreduce.Job:  map 5% reduce 0%
2025-11-05 23:59:33,100 INFO mapreduce.Job:  map 6% reduce 0%
2025-11-05 23:59:35,748 INFO mapreduce.Job:  map 8% reduce 0%
2025-11-05 23:59:40,600 INFO mapreduce.Job:  map 9% reduce 0%
2025-11-05 23:59:41,855 INFO mapreduce.Job:  map 10% reduce 0%
2025-11-05 23:59:45,732 INFO mapreduce.Job:  map 11% reduce 0%
2025-11-05 23:59:48,276 INFO mapreduce.Job:  map 12% reduce 0%
2025-11-05 23:59:58,529 INFO mapreduce.Job:  map 13% reduce 0%
2025-11-06 00:00:03,827 INFO mapreduce.Job:  map 16% reduce 0%
2025-11-06 00:00:05,887 INFO mapreduce.Job:  map 17% reduce 0%
2025-11-06 00:00:28,435 INFO mapreduce.Job:  map 18% reduce 0%
2025-11-06 00:01:03,145 INFO mapreduce.Job:  map 25% reduce 6%
2025-11-06 00:01:11,656 INFO mapreduce.Job:  map 28% reduce 6%
2025-11-06 00:01:14,208 INFO mapreduce.Job:  map 29% reduce 6%
2025-11-06 00:01:16,269 INFO mapreduce.Job:  map 30% reduce 6%
2025-11-06 00:01:17,338 INFO mapreduce.Job:  map 31% reduce 8%
2025-11-06 00:01:19,425 INFO mapreduce.Job:  map 32% reduce 8%
2025-11-06 00:01:21,530 INFO mapreduce.Job:  map 33% reduce 8%
2025-11-06 00:01:23,681 INFO mapreduce.Job:  map 33% reduce 11%
2025-11-06 00:01:49,703 INFO mapreduce.Job:  map 43% reduce 11%
2025-11-06 00:01:54,579 INFO mapreduce.Job:  map 45% reduce 11%
2025-11-06 00:01:55,681 INFO mapreduce.Job:  map 47% reduce 11%
2025-11-06 00:01:56,840 INFO mapreduce.Job:  map 48% reduce 11%
2025-11-06 00:02:00,132 INFO mapreduce.Job:  map 48% reduce 16%
2025-11-06 00:02:25,290 INFO mapreduce.Job:  map 58% reduce 16%
2025-11-06 00:02:30,922 INFO mapreduce.Job:  map 59% reduce 16%
2025-11-06 00:02:32,236 INFO mapreduce.Job:  map 59% reduce 17%
2025-11-06 00:02:35,524 INFO mapreduce.Job:  map 61% reduce 17%
2025-11-06 00:02:38,741 INFO mapreduce.Job:  map 63% reduce 17%
2025-11-06 00:02:39,793 INFO mapreduce.Job:  map 63% reduce 19%
2025-11-06 00:02:41,854 INFO mapreduce.Job:  map 64% reduce 19%
2025-11-06 00:02:44,954 INFO mapreduce.Job:  map 64% reduce 21%
2025-11-06 00:03:02,676 INFO mapreduce.Job:  map 68% reduce 21%
2025-11-06 00:03:03,836 INFO mapreduce.Job:  map 70% reduce 21%
2025-11-06 00:03:08,581 INFO mapreduce.Job:  map 74% reduce 21%
2025-11-06 00:03:10,241 INFO mapreduce.Job:  map 75% reduce 23%
2025-11-06 00:03:11,311 INFO mapreduce.Job:  map 77% reduce 23%
2025-11-06 00:03:15,463 INFO mapreduce.Job:  map 78% reduce 24%
2025-11-06 00:03:17,592 INFO mapreduce.Job:  map 79% reduce 24%
2025-11-06 00:03:21,900 INFO mapreduce.Job:  map 79% reduce 26%
2025-11-06 00:03:41,913 INFO mapreduce.Job:  map 83% reduce 26%
2025-11-06 00:03:43,945 INFO mapreduce.Job:  map 85% reduce 26%
2025-11-06 00:03:46,089 INFO mapreduce.Job:  map 89% reduce 26%
2025-11-06 00:03:47,248 INFO mapreduce.Job:  map 90% reduce 26%
2025-11-06 00:03:49,680 INFO mapreduce.Job:  map 91% reduce 26%
2025-11-06 00:03:51,818 INFO mapreduce.Job:  map 94% reduce 26%
2025-11-06 00:03:53,933 INFO mapreduce.Job:  map 94% reduce 31%
2025-11-06 00:04:03,108 INFO mapreduce.Job:  map 97% reduce 31%
2025-11-06 00:04:04,119 INFO mapreduce.Job:  map 100% reduce 31%
2025-11-06 00:04:06,136 INFO mapreduce.Job:  map 100% reduce 35%
2025-11-06 00:04:12,235 INFO mapreduce.Job:  map 100% reduce 47%
2025-11-06 00:04:17,300 INFO mapreduce.Job:  map 100% reduce 63%
2025-11-06 00:04:23,427 INFO mapreduce.Job:  map 100% reduce 88%
2025-11-06 00:04:25,440 INFO mapreduce.Job:  map 100% reduce 100%
2025-11-06 00:04:29,595 INFO mapreduce.Job: Job job_1762367237082_0001 completed successfully
2025-11-06 00:04:30,679 INFO mapreduce.Job: Counters: 55
	File System Counters
		FILE: Number of bytes read=1152809315
		FILE: Number of bytes written=248349602
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=4620
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=33
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
		HDFS: Number of bytes read erasure-coded=0
	Job Counters 
		Killed map tasks=1
		Launched map tasks=33
		Launched reduce tasks=1
		Rack-local map tasks=33
		Total time spent by all maps in occupied slots (ms)=1325415
		Total time spent by all reduces in occupied slots (ms)=233046
		Total time spent by all map tasks (ms)=1325415
		Total time spent by all reduce tasks (ms)=233046
		Total vcore-milliseconds taken by all map tasks=1325415
		Total vcore-milliseconds taken by all reduce tasks=233046
		Total megabyte-milliseconds taken by all map tasks=1357224960
		Total megabyte-milliseconds taken by all reduce tasks=238639104
	Map-Reduce Framework
		Map input records=68993777
		Map output records=68993773
		Map output bytes=780851604
		Map output materialized bytes=121088551
		Input split bytes=4620
		Combine input records=68993773
		Combine output records=25096013
		Reduce input groups=4489240
		Reduce shuffle bytes=121088551
		Reduce input records=25096013
		Reduce output records=4489240
		Spilled Records=50192026
		Shuffled Maps =33
		Failed Shuffles=0
		Merged Map outputs=33
		GC time elapsed (ms)=41456
		CPU time spent (ms)=555420
		Physical memory (bytes) snapshot=16826109952
		Virtual memory (bytes) snapshot=93441306624
		Total committed heap usage (bytes)=13475250176
		Peak Map Physical memory (bytes)=737619968
		Peak Map Virtual memory (bytes)=2756784128
		Peak Reduce Physical memory (bytes)=524906496
		Peak Reduce Virtual memory (bytes)=2772566016
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=1080729114
	File Output Format Counters 
		Bytes Written=45792224
Job 1 completed in: 358267 ms
=== STARTING MAPREDUCE JOB 2: Calculate Distribution ===
2025-11-06 00:04:31,017 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2025-11-06 00:04:31,320 WARN mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2025-11-06 00:04:31,368 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/dinesh/.staging/job_1762367237082_0002
2025-11-06 00:04:32,862 INFO input.FileInputFormat: Total input files to process : 1
2025-11-06 00:04:34,340 INFO mapreduce.JobSubmitter: number of splits:2
2025-11-06 00:04:35,086 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1762367237082_0002
2025-11-06 00:04:35,087 INFO mapreduce.JobSubmitter: Executing with tokens: []
2025-11-06 00:04:35,414 INFO impl.YarnClientImpl: Submitted application application_1762367237082_0002
2025-11-06 00:04:35,466 INFO mapreduce.Job: The url to track the job: http://dinesh-VirtualBox:8088/proxy/application_1762367237082_0002/
2025-11-06 00:04:35,467 INFO mapreduce.Job: Running job: job_1762367237082_0002
2025-11-06 00:04:45,100 INFO mapreduce.Job: Job job_1762367237082_0002 running in uber mode : false
2025-11-06 00:04:45,100 INFO mapreduce.Job:  map 0% reduce 0%
2025-11-06 00:04:57,630 INFO mapreduce.Job:  map 50% reduce 0%
2025-11-06 00:04:59,677 INFO mapreduce.Job:  map 100% reduce 0%
2025-11-06 00:05:03,782 INFO mapreduce.Job:  map 100% reduce 100%
2025-11-06 00:05:05,885 INFO mapreduce.Job: Job job_1762367237082_0002 completed successfully
2025-11-06 00:05:05,908 INFO mapreduce.Job: Counters: 55
	File System Counters
		FILE: Number of bytes read=45816498
		FILE: Number of bytes written=865128
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=346
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=2
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
		HDFS: Number of bytes read erasure-coded=0
	Job Counters 
		Killed map tasks=1
		Launched map tasks=2
		Launched reduce tasks=1
		Rack-local map tasks=2
		Total time spent by all maps in occupied slots (ms)=19093
		Total time spent by all reduces in occupied slots (ms)=3071
		Total time spent by all map tasks (ms)=19093
		Total time spent by all reduce tasks (ms)=3071
		Total vcore-milliseconds taken by all map tasks=19093
		Total vcore-milliseconds taken by all reduce tasks=3071
		Total megabyte-milliseconds taken by all map tasks=19551232
		Total megabyte-milliseconds taken by all reduce tasks=3144704
	Map-Reduce Framework
		Map input records=4489240
		Map output records=4489240
		Map output bytes=35913920
		Map output materialized bytes=13623
		Input split bytes=346
		Combine input records=4489240
		Combine output records=2510
		Reduce input groups=1569
		Reduce shuffle bytes=13623
		Reduce input records=2510
		Reduce output records=1569
		Spilled Records=5020
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=719
		CPU time spent (ms)=16380
		Physical memory (bytes) snapshot=1144795136
		Virtual memory (bytes) snapshot=8242450432
		Total committed heap usage (bytes)=828375040
		Peak Map Physical memory (bytes)=492769280
		Peak Map Virtual memory (bytes)=2757001216
		Peak Reduce Physical memory (bytes)=187887616
		Peak Reduce Virtual memory (bytes)=2738573312
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Input Format Counters 
		Bytes Read=45804508
	File Output Format Counters 
		Bytes Written=11033
Job 2 completed in: 35126 ms
TOTAL MAPREDUCE TIME: 393494 ms
=== MAPREDUCE ANALYSIS COMPLETE ===
----------------------------------------
Job exit status: 0
OPTIMIZED Hadoop completed successfully!
Execution time: 396 seconds

=== RESULTS ===
Sample distribution (first 10):
1	1014392
2	553207
3	359549
4	264944
5	208763
6	171471
7	144484
8	124284
9	109053
10	96523

Total distribution entries: 1569
Output file size: 11K

Top 5 most common in-degrees:
1	1014392
2	553207
3	359549
4	264944
5	208763

Full results saved to: /home/dinesh/bigdata-assignment/results/live-journal/hadoop-optimized/output-20251105_235827/part-r-00000

=== OPTIMIZED EXECUTION SUMMARY ===
Dataset: live-journal
Input file: soc-LiveJournal1.txt
File size: 1.1G (1080598042 bytes)
Execution time: 396 seconds
Job status: SUCCESS
Mode: OPTIMIZED Local filesystem
End time: Thu Nov  6 12:05:06 AM +0530 2025

OPTIMIZATION SUMMARY:
  Applied: Memory tuning only
  Map memory: 3GB (vs 2GB default)
  Reduce memory: 4GB (vs 2GB default)
  JAR file: indegree-optimized.jar
  Status: SUCCESS

LOG FILES SAVED:
  Complete log: /home/dinesh/bigdata-assignment/results/live-journal/hadoop-optimized/hadoop_optimized_20251105_235827.log
  Results: /home/dinesh/bigdata-assignment/results/live-journal/hadoop-optimized/output-20251105_235827/
========================================
